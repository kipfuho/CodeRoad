<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ORA 2</title>
    <link rel="stylesheet" href="ora2.css"/>
  </head>
  <body>
    <div class="content-title center">
      THÔNG TIN CÁ NHÂN
      <hr>
    </div>
    <div>
      <div id="studentInfoDiv">
        <div class="content-title">
          <div class="flex">
            <span id="title1">THÔNG TIN SINH VIÊN</span>
            <button 
              id="editButton"
              class="basic-button"
              href="ora1_2.html"
            >
              <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" fill="currentColor" class="bi bi-pencil-square" viewBox="0 0 16 16">
                <path d="M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"/>
                <path fill-rule="evenodd" d="M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5z"/>
              </svg>
            </button>
          </div>
          <hr class="hr-content">
        </div>
        <div class="flex">
          <div class="pfp-container">
            <img 
              id="studentImage"
              class="profile-picture"
              alt="img"
            />
            <div class="center">
              <button id="imageChangeButton" style="display: none; margin-bottom: 10px;">Change image</button>
            </div>
            <div class="center flex">
              <span class="item">MSSV:</span>
              <span 
                id="mssv" 
                class="item-data"
              ></span>
              <input 
                id="mssvEdit"
                name="mssv"
                class="item-data"
                style="display: none;"
                type="number"
                required
              />
            </div>
          </div>
          <div class="item-container">
            <span class="item">Họ và tên :</span>
            <span 
              id="fullname" 
              class="item-data"
            ></span>
            <input 
              id="fullnameEdit"
              name="fullname"
              class="item-data" 
              style="display: none;"
              type="text"
              required
            /><br>

            <span class="item">Năm vào trường :</span> 
            <span 
              id="yearEnter"
              class="item-data"
            ></span>
            <input 
              id="yearEnterEdit"
              name="enteryear"
              class="item-data"
              style="display: none;"
              type="number"
              required
            /><br>

            <span class="item">Bậc đào tạo :</span> 
            <span 
              id="trainType"
              class="item-data"
            ></span>
            <select 
              id="trainTypeEdit"
              name="traintype"
              class="item-data"
              style="display: none;"
            >
              <option>Đại học đại trà</option>
              <option>Đào tạo tài năng</option>
              <option>Khác</option>
            </select><br>

            <span class="item">Chương trình :</span> 
            <span 
              id="program"
              class="item-data"
            ></span>
            <input 
              id="programEdit"
              name="program"
              class="item-data"
              style="display: none;"
              type="text"
              required
            /><br>

            <span class="item">Khoa/Viện quản lý :</span> 
            <span 
              id="manageschool"
              class="item-data"
            ></span>
            <select 
              id="manageschoolEdit"
              name="manageschool"
              class="item-data"
              style="display: none;"
            >
              <option>Trường Công nghệ thông tin và Truyền thông</option>
              <option>Trường Cơ khí</option>
              <option>Trường Điện - Điện tử</option>
              <option>Trường Hoá và Khoa học sự sống</option>
              <option>Trường Vật liệu</option>
              <option>Khoa Toán - Tin</option>
              <option>Khoa Vật lý Kỹ thuật</option>
              <option>Viện Kinh tế và Quản lý</option>
              <option>Khoa Ngoại ngữ</option>
              <option>Khoa Khoa học và Công nghệ Giáo dục</option>
            </select><br>

            <span class="item">Tình trạng học tập :</span> 
            <span 
              id="studystate"
              class="item-data"
            ></span>
            <select 
              id="studystateEdit"
              name="studystate"
              class="item-data"
              style="display: none;"
            >
              <option>Học</option>
              <option>Nghỉ</option>
            </select><br>
          </div>
          <div class="item-container">
            <span class="item">Giới tính :</span> 
            <span 
              id="gender"
              class="item-data"
            ></span>
            <select 
              id="genderEdit"
              name="gender"
              class="item-data"
              style="display: none;"
            >
              <option>Nam</option>
              <option>Nữ</option>
            </select><br>

            <span class="item">Lớp :</span> 
            <span 
              id="classes"
              class="item-data"
            ></span>
            <input 
              id="classesEdit"
              name="classes"
              class="item-data"
              style="display: none;"
              type="text"
              required
            /><br>

            <span class="item">Khóa học :</span> 
            <span 
              id="course"
              class="item-data"
            ></span>
            <input 
              id="courseEdit"
              name="course"
              class="item-data" 
              style="display: none;"
              type="number"
              required
            /><br>

            <span class="item">Email :</span> 
            <span 
              id="email"
              class="item-data"
            ></span>
            <input 
              id="emailEdit"
              name="email"
              class="item-data" 
              style="display: none;"
              type="email"
              required
            /><br>
          </div>
        </div>
        <div 
          id="editButtonDiv"
          class="flex justify-center"
          style="display: none;"
        >
          <button 
            id="saveButton"
            class="basic-button"
          >
            SAVE
          </button>
          <button 
            id="cancelButton"
            class="basic-button"
          >
            CANCEL
          </button>
          <button 
            id="resetButton"
            class="basic-button"
          >
            RESET
          </button>
        </div>
      </div>
      <div id="studyInfoDiv">
        <div class="content-title">
          <span>THÔNG TIN HỌC TẬP</span>
          <hr class="hr-content">
        </div>
        
        <div class="flex">
          <div class="item-container">
            <span class="item">Tổng kết học kỳ :</span> 
            <span class="item-data">20231</span><br>

            <span class="item">Trung bình tích lũy :</span> 
            <span class="item-data">3.43</span><br>

            <span class="item">Số TC nợ đăng ký :</span> 
            <span class="item-data">0</span><br>
          </div>
          <div class="item-container">
            <span class="item">Số TC tích lũy :</span> 
            <span class="item-data">88</span><br>
            
            <span class="item">Trình độ sinh viên :</span> 
            <span class="item-data">3</span><br>

            <span class="item">Mức cảnh báo :</span> 
            <span class="item-data">M0</span><br>
          </div>
        </div>
      </div>
      <div id="individualInfoDiv">
        <div class="content-title">
          <span>THÔNG TIN CÁ NHÂN</span>
          <hr class="hr-content">
        </div>
        <div class="flex">
          <div class="item-container">
            <span class="item">Dân tộc :</span> 
            <span class="item-data">KINH</span><br>

            <span class="item">Năm TN cấp 3 :</span> 
            <span class="item-data">2021</span><br>

            <span class="item">Địa chỉ :</span> 
            <span class="item-data">XÃ LÃNG NGÂM, HUYỆN GIA BÌNH, TỈNH BẮC NINH</span><br>

            <span class="item">Số CMTND :</span> 
            <span class="item-data">027***07</span><br>

            <span class="item">Nơi cấp :</span> 
            <span class="item-data">QUẢNG NINH</span><br>

            <span class="item">Họ tên bố :</span> 
            <span class="item-data">NGUYỄN ĐÌNH HUYÊN</span><br>

            <span class="item">Năm sinh :</span> 
            <span class="item-data">1957</span><br>

            <span class="item">Nghề nghiệp :</span> 
            <span class="item-data">NÔNG DÂN</span><br>

            <span class="item">Điện thoại :</span> 
            <span class="item-data">097***86</span><br>

            <span class="item">Email :</span> 
            <span class="item-data">KHÔNG CÓ</span><br>
          </div>
          <div class="item-container">
            <span class="item">Tôn giáo :</span> 
            <span class="item-data">KHÔNG</span><br>

            <span class="item">Trường THPT :</span> 
            <span class="item-data">THPT LÊ VĂN THỊNH</span><br>

            <span class="item">Hộ khẩu :</span> 
            <span class="item-data">XÃ LÃNG NGÂM, HUYỆN GIA BÌNH, TỈNH BẮC NINH</span><br>

            <span class="item">Số Điện thoại :</span> 
            <span class="item-data">039***93</span><br>

            <span class="item">Họ tên mẹ :</span> 
            <span class="item-data">NGÔ THỊ THU</span><br>

            <span class="item">Năm sinh :</span> 
            <span class="item-data">1969</span><br>

            <span class="item">Nghề nghiệp :</span> 
            <span class="item-data">NÔNG DÂN</span><br>

            <span class="item">Điện thoại :</span> 
            <span class="item-data">KHÔ***CÓ</span><br>

            <span class="item">Email :</span> 
            <span class="item-data">KHÔNG CÓ</span><br>
          </div>
        </div>
      </div>
      <div 
        id="noticeDiv"
        class="notice"
      >
        <span class="item">Ghi chú:</span>
        <span class="item-data">Nếu sinh viên thấy thông tin của mình chưa chính xác, xin vui lòng liên hệ phòng Đào tạo để cập nhật lại.</span>
      </div>
    </div>
    <script>
      let ttsv = {
        avatarSrc: "ava.png",
        mssv: 20215317,
        fullname: "Nguyễn Đình Út Biu",
        yearEnter: 2021,
        trainType: "Đại học đại trà",
        program: "Khoa học Máy tính 2021",
        manageschool: "Trường Công nghệ thông tin và Truyền thông",
        study: true,
        male: true,
        class: "Khoa học máy tính 05-K66",
        course: 66,
        email: "biu.ndu215317@sis.hust.edu.vn"
      }

      // find options index of select tag
      function FindOption(element, text) {
        var index = 0;
        for(; index < element.length; index++){
          if(element.options[index].innerHTML === text){
            break;
          }
        }
        return index;
      }
      
      // switch between edit and view state
      function ChangeStateDisplay(edit) {
        document.getElementById("studyInfoDiv").style.display=edit ? "none" : "";
        document.getElementById("individualInfoDiv").style.display=edit ? "none" : "";
        document.getElementById("noticeDiv").style.display=edit ? "none" : "";
        document.getElementById("title1").innerHTML=edit ? "SỬA THÔNG TIN SINH VIÊN": "THÔNG TIN SINH VIÊN";
        document.getElementById("editButtonDiv").style.display=edit ? "" : "none";
        document.getElementById("editButton").style.display=edit ? "none" : "";
        document.getElementById("imageChangeButton").style.display=edit ? "" : "none";
      }

      // show or hide data editor
      function ChangeEditorDisplay(none) {
        document.getElementById("mssvEdit").style.display=none?"none":"";
        document.getElementById("fullnameEdit").style.display=none?"none":"";
        document.getElementById("yearEnterEdit").style.display=none?"none":"";
        document.getElementById("trainTypeEdit").style.display=none?"none":"";
        document.getElementById("programEdit").style.display=none?"none":"";
        document.getElementById("manageschoolEdit").style.display=none?"none":"";
        document.getElementById("studystateEdit").style.display=none?"none":"";
        document.getElementById("genderEdit").style.display=none?"none":"";
        document.getElementById("classesEdit").style.display=none?"none":"";
        document.getElementById("courseEdit").style.display=none?"none":"";
        document.getElementById("emailEdit").style.display=none?"none":"";
      }

      // show or hide data displayer
      function ChangeHolderDisplay(none) {
        document.getElementById("mssv").style.display=none?"none":"";
        document.getElementById("fullname").style.display=none?"none":"";
        document.getElementById("yearEnter").style.display=none?"none":"";
        document.getElementById("trainType").style.display=none?"none":"";
        document.getElementById("program").style.display=none?"none":"";
        document.getElementById("manageschool").style.display=none?"none":"";
        document.getElementById("studystate").style.display=none?"none":"";
        document.getElementById("gender").style.display=none?"none":"";
        document.getElementById("classes").style.display=none?"none":"";
        document.getElementById("course").style.display=none?"none":"";
        document.getElementById("email").style.display=none?"none":"";
      }

      // Change data holder value to ttsv object's value
      function changeInformation() {
        document.getElementById("studentImage").src=ttsv.avatarSrc;
        document.getElementById("mssv").innerHTML=ttsv.mssv;
        document.getElementById("fullname").innerHTML=ttsv.fullname;
        document.getElementById("yearEnter").innerHTML=ttsv.yearEnter;
        document.getElementById("trainType").innerHTML=ttsv.trainType;
        document.getElementById("program").innerHTML=ttsv.program;
        document.getElementById("manageschool").innerHTML=ttsv.manageschool;
        document.getElementById("studystate").innerHTML=ttsv.study ? "Học" : "Nghỉ";
        document.getElementById("gender").innerHTML=ttsv.male ? "Nam" : "Nữ";
        document.getElementById("classes").innerHTML=ttsv.class;
        document.getElementById("course").innerHTML=ttsv.course;
        document.getElementById("email").innerHTML=ttsv.email;
      }

      // change data editor value to object's value
      function changeEditInformation() {
        document.getElementById("studentImage").src=ttsv.avatarSrc;
        document.getElementById("mssvEdit").value=ttsv.mssv;
        document.getElementById("fullnameEdit").value=ttsv.fullname;
        document.getElementById("yearEnterEdit").value=ttsv.yearEnter
        document.getElementById("trainTypeEdit").selectedIndex=FindOption(document.getElementById("trainTypeEdit"), ttsv.trainType);
        document.getElementById("programEdit").value=ttsv.program;
        document.getElementById("manageschoolEdit").selectedIndex=FindOption(document.getElementById("manageschoolEdit"), ttsv.manageschool);
        document.getElementById("studystateEdit").selectedIndex=FindOption(document.getElementById("studystateEdit"), ttsv.study ? "Học" : "Nghỉ");
        document.getElementById("genderEdit").selectedIndex=FindOption(document.getElementById("genderEdit"), ttsv.male ? "Nam" : "Nữ");
        document.getElementById("classesEdit").value=ttsv.class;
        document.getElementById("courseEdit").value=ttsv.course;
        document.getElementById("emailEdit").value=ttsv.email;
      }

      // save edited information to ttsv object
      function saveToTTSV() {
        ttsv.avatarSrc=document.getElementById("studentImage").src;
        ttsv.mssv=document.getElementById("mssvEdit").value;
        ttsv.fullname=document.getElementById("fullnameEdit").value;
        ttsv.yearEnter=document.getElementById("yearEnterEdit").value;
        ttsv.trainType=document.getElementById("trainTypeEdit").options[document.getElementById("trainTypeEdit").selectedIndex].innerHTML;
        ttsv.program=document.getElementById("programEdit").value;
        ttsv.manageschool=document.getElementById("manageschoolEdit").options[document.getElementById("manageschoolEdit").selectedIndex].innerHTML;
        ttsv.study=document.getElementById("studystateEdit").options[document.getElementById("studystateEdit").selectedIndex].innerHTML === "Học";
        ttsv.male=document.getElementById("genderEdit").options[document.getElementById("genderEdit").selectedIndex].innerHTML === "Nam";
        ttsv.class=document.getElementById("classesEdit").value;
        ttsv.course=document.getElementById("courseEdit").value;
        ttsv.email=document.getElementById("emailEdit").value;
      }

      // choose a new image as avatar
      function editImage() {
        let input = document.createElement('input');
        input.type = 'file';
        input.onchange = _this => {
          let files = input.files;
          document.getElementById("studentImage");
          if (files && files[0]) {
            let reader = new FileReader();
            reader.onload = function(event) {
                document.getElementById("studentImage").src = event.target.result;
            };
            reader.readAsDataURL(files[0]);
        }
        };
        input.click();
      }

      // function for edit click event
      function editClick() {
        ChangeStateDisplay(true); // edit state
        ChangeEditorDisplay(false); // show data editor
        ChangeHolderDisplay(true); // hide data displayer
        changeEditInformation();
      }

      // function for save click event
      function saveClick() {
        ChangeStateDisplay(false); // view state
        ChangeEditorDisplay(true);  // hide data editor
        ChangeHolderDisplay(false); // show data displayer
        saveToTTSV(); // save
        changeInformation(); // change
        console.log(ttsv);
      }

      // function for cancel click event
      function cancelClick() {
        ChangeStateDisplay(false); // view state
        ChangeEditorDisplay(true); // hide data editor
        ChangeHolderDisplay(false); // show data displayer
        changeInformation(); // change data's value to previous 
        console.log(ttsv);
      }

      // function for reset click event
      function resetClick() {
        ttsv = {
          avatarSrc: "ava.png",
          mssv: 20215317,
          fullname: "Nguyễn Đình Út Biu",
          yearEnter: 2021,
          trainType: "Đại học đại trà",
          program: "Khoa học Máy tính 2021",
          manageschool: "Trường Công nghệ thông tin và Truyền thông",
          study: true,
          male: true,
          class: "Khoa học máy tính 05-K66",
          course: 66,
          email: "biu.ndu215317@sis.hust.edu.vn"
        }
        changeEditInformation();
        console.log(ttsv);
      }

      // initiator
      changeInformation();
      document.getElementById("editButton").onclick = function() {editClick()};
      document.getElementById("saveButton").onclick = function() {saveClick()};
      document.getElementById("cancelButton").onclick = function() {cancelClick()};
      document.getElementById("resetButton").onclick = function() {resetClick()};
      document.getElementById("imageChangeButton").onclick = function() {editImage()};
    </script>
  </body>
</html>